<?xml version="1.0" encoding="ASCII"?>
<CompleteFSM:StateMachine
    xmi:version="2.0"
    xmlns:xmi="http://www.omg.org/XMI"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:CompleteFSM="http://CompleteFSM"
    xsi:schemaLocation="http://CompleteFSM ../fr.inria.diverse.examples.puzzle.fsm.CompleteFSM/composition-gen/CompleteFSM.ecore"
    name="CoolStateMachine">
  <regions name="XYZ">
    <subvertex
        xsi:type="CompleteFSM:Pseudostate"
        name="Initial"
        outgoing="//@regions.0/@transitions.0"/>
    <subvertex
        xsi:type="CompleteFSM:State"
        name="X"
        incoming="//@regions.0/@transitions.0"
        outgoing="//@regions.0/@transitions.1"/>
    <subvertex
        xsi:type="CompleteFSM:State"
        name="Y"
        incoming="//@regions.0/@transitions.1"
        outgoing="//@regions.0/@transitions.2"/>
    <subvertex
        xsi:type="CompleteFSM:State"
        name="T"
        incoming="//@regions.0/@transitions.2"
        outgoing="//@regions.0/@transitions.3">
      <ownedRegions
          name="RegionT">
        <subvertex
            xsi:type="CompleteFSM:Pseudostate"
            name="InitialT"
            outgoing="//@regions.0/@subvertex.3/@ownedRegions.0/@transitions.0"/>
        <subvertex
            xsi:type="CompleteFSM:Pseudostate"
            name="Conditional"
            incoming="//@regions.0/@subvertex.3/@ownedRegions.0/@transitions.0"
            outgoing="//@regions.0/@subvertex.3/@ownedRegions.0/@transitions.1 //@regions.0/@subvertex.3/@ownedRegions.0/@transitions.2"
            kind="conditional"/>
        <subvertex
            xsi:type="CompleteFSM:State"
            name="O"
            incoming="//@regions.0/@subvertex.3/@ownedRegions.0/@transitions.1"
            outgoing="//@regions.0/@subvertex.3/@ownedRegions.0/@transitions.3"/>
        <subvertex
            xsi:type="CompleteFSM:State"
            name="P"
            incoming="//@regions.0/@subvertex.3/@ownedRegions.0/@transitions.2"
            outgoing="//@regions.0/@subvertex.3/@ownedRegions.0/@transitions.4"/>
        <subvertex
            xsi:type="CompleteFSM:State"
            name="R"
            incoming="//@regions.0/@subvertex.3/@ownedRegions.0/@transitions.3 //@regions.0/@subvertex.3/@ownedRegions.0/@transitions.4"
            outgoing="//@regions.0/@transitions.5"/>
        <transitions
            name="InitialToConditional"
            target="//@regions.0/@subvertex.3/@ownedRegions.0/@subvertex.1"
            source="//@regions.0/@subvertex.3/@ownedRegions.0/@subvertex.0"/>
        <transitions
            name="ConditionalToO"
            target="//@regions.0/@subvertex.3/@ownedRegions.0/@subvertex.2"
            source="//@regions.0/@subvertex.3/@ownedRegions.0/@subvertex.1">
          <guard
              xsi:type="CompleteFSM:RelationalConstraint">
            <left
                xsi:type="CompleteFSM:CVarRef"
                name="y"/>
            <right
                xsi:type="CompleteFSM:CInteger"
                value="1"/>
          </guard>
        </transitions>
        <transitions
            name="ConditionalToP"
            target="//@regions.0/@subvertex.3/@ownedRegions.0/@subvertex.3"
            source="//@regions.0/@subvertex.3/@ownedRegions.0/@subvertex.1">
          <guard
              xsi:type="CompleteFSM:RelationalConstraint"
              operator="greaterThan">
            <left
                xsi:type="CompleteFSM:CVarRef"
                name="y"/>
            <right
                xsi:type="CompleteFSM:CInteger"
                value="1"/>
          </guard>
        </transitions>
        <transitions
            name="OToR"
            target="//@regions.0/@subvertex.3/@ownedRegions.0/@subvertex.4"
            source="//@regions.0/@subvertex.3/@ownedRegions.0/@subvertex.2">
          <trigger
              expression="e3"/>
        </transitions>
        <transitions
            name="PToR"
            target="//@regions.0/@subvertex.3/@ownedRegions.0/@subvertex.4"
            source="//@regions.0/@subvertex.3/@ownedRegions.0/@subvertex.3">
          <trigger
              expression="e3"/>
        </transitions>
      </ownedRegions>
    </subvertex>
    <subvertex
        xsi:type="CompleteFSM:State"
        name="W"
        incoming="//@regions.0/@transitions.3"
        outgoing="//@regions.0/@transitions.4"/>
    <subvertex
        xsi:type="CompleteFSM:FinalState"
        name="Z"
        incoming="//@regions.0/@transitions.4 //@regions.0/@transitions.5"/>
    <transitions
        name="InitialToX"
        target="//@regions.0/@subvertex.1"
        source="//@regions.0/@subvertex.0"/>
    <transitions
        name="XToY"
        target="//@regions.0/@subvertex.2"
        source="//@regions.0/@subvertex.1">
      <trigger
          expression="e1"/>
    </transitions>
    <transitions
        name="YToT"
        target="//@regions.0/@subvertex.3"
        source="//@regions.0/@subvertex.2">
      <trigger
          expression="e2"/>
      <effect
          xsi:type="CompleteFSM:Program">
        <statements
            xsi:type="CompleteFSM:PutInMemory"
            key="x">
          <value
              xsi:type="CompleteFSM:IntegerLit"
              value="1"/>
        </statements>
      </effect>
      <effect
          xsi:type="CompleteFSM:Program">
        <statements
            xsi:type="CompleteFSM:PutInMemory"
            key="y">
          <value
              xsi:type="CompleteFSM:ArithmeticExpression">
            <left
                xsi:type="CompleteFSM:GetFromMemory"
                key="x"/>
            <right
                xsi:type="CompleteFSM:IntegerLit"
                value="1"/>
          </value>
        </statements>
      </effect>
    </transitions>
    <transitions
        name="TToW"
        target="//@regions.0/@subvertex.4"
        source="//@regions.0/@subvertex.3">
      <trigger
          expression="e3"/>
    </transitions>
    <transitions
        name="WToZ"
        target="//@regions.0/@subvertex.5"
        source="//@regions.0/@subvertex.4">
      <trigger
          expression="e4"/>
    </transitions>
    <transitions
        name="RToZ"
        target="//@regions.0/@subvertex.5"
        source="//@regions.0/@subvertex.3/@ownedRegions.0/@subvertex.4">
      <trigger
          expression="e4"/>
    </transitions>
  </regions>
</CompleteFSM:StateMachine>
