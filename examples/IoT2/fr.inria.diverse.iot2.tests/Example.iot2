// Simple IoT system

system MySystem {
	sensor Thermometer {
		provides operation getTemperature(out long i) {
			print("Hello, myOp1")
			i = 55
			print("Done")
		}
	}

	actuator Heater {
		provides operation setTemperature(in long i) {
			print("i=")
			print(i)
		}
	}

	board B1 [Arduino] {
		provides Thermometer
	}

	board B2 [RaspberryPi] {
		provides Heater
	}

	sketch {
		activity test1 {
			nodes {
				initial init1 out (e1),
				fork fork1 in (e1) out (e2, e3),
				action a1 in (e2) out (e4) service getTemperature,
				action a2 in (e3) out (e5) service setTemperature,
				join join1 in (e4, e5) out (e6),
				final final1 in (e6)
			}
			edges {
				flow e1 from init1 to fork1,
				flow e2 from fork1 to a1,
				flow e3 from fork1 to a2,
				flow e4 from a1 to join1,
				flow e5 from a2 to join1,
				flow e6 from join1 to final1 
			}
		}
	}
}
